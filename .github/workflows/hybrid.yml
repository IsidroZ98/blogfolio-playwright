name: Hybrid CI

on:
  push:
  pull_request:

jobs:
  # ------------------------------
  # 1. Light, fast checks (cloud)
  # ------------------------------
  lint:
    name: Lint (Cloud)
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: npm install
      - run: npm run lint

  unit_tests:
    name: Unit Tests (Cloud)
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - run: npm install
      - run: npm test

  mac_build:
    name: MacOS Build (Self-hosted Mac)
    runs-on: [self-hosted, macos]
    needs: [lint, unit_tests]
    steps:
      - uses: actions/checkout@v4
      - run: echo "Running on my REAL Mac..."
      - run: make build

  linux_build:
    name: Linux Build (Self-hosted x86 Linux)
    runs-on: [self-hosted, linux]
    needs: [lint, unit_tests]
    steps:
      - uses: actions/checkout@v4
      - run: echo "Running Linux build..."
      - run: make build-linux
